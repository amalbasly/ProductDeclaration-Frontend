<div class="card">
  <div class="card-header">
    <h3>Créer une nouvelle découpe de flan</h3>
  </div>
  <div class="card-body">
    <div *ngIf="errorMessage" class="alert alert-danger">
      {{ errorMessage }}
    </div>
    <div *ngIf="successMessage" class="alert alert-success">
      {{ successMessage }}
    </div>

    <form (ngSubmit)="onSubmit()" #flanForm="ngForm">
      <div class="form-group">
        <label for="ptNumOriginal">Nom Produit</label>
        <select class="form-control" id="ptNumOriginal"
                [(ngModel)]="model.ptNumOriginal" name="ptNumOriginal" required
                [disabled]="productNames.length === 0">
          <option *ngIf="productNames.length === 0" value="" disabled>Aucun produit disponible</option>
          <option *ngFor="let product of productNames" [value]="product">{{ product }}</option>
        </select>
      </div>

      <div class="form-group">
        <label for="nombreDeParts">Nombre de parts</label>
        <input type="number" class="form-control" id="nombreDeParts"
               [(ngModel)]="model.nombreDeParts" name="nombreDeParts" min="1" required>
      </div>

      <div class="form-group">
        <label for="labelUtilise">Label utilisé</label>
        <select class="form-control" id="labelUtilise"
                [(ngModel)]="model.labelUtilise" name="labelUtilise" required
                [disabled]="labelNames.length === 0">
          <option *ngIf="labelNames.length === 0" value="" disabled>Aucun label disponible</option>
          <option *ngFor="let label of labelNames" [value]="label">{{ label }}</option>
        </select>
      </div>

      <div class="form-group">
        <label for="utilisateur">Utilisateur (optionnel)</label>
        <input type="text" class="form-control" id="utilisateur"
               [(ngModel)]="model.utilisateur" name="utilisateur">
      </div>

      <button type="submit" class="btn btn-primary"
              [disabled]="!flanForm.form.valid || isSubmitting || productNames.length === 0 || labelNames.length === 0">
        <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm"></span>
        {{ isSubmitting ? 'Création en cours...' : 'Créer' }}
      </button>
    </form>
  </div>
</div>